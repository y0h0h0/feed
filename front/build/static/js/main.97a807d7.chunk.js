(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{188:function(e,t,n){},209:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},212:function(e,t,n){},213:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(92),s=n.n(o),l=n(33),i=n(34),c=n(36),u=n(35),m=n(37),p=(n(188),n(10)),d=n.n(p),g=n(21),f=n(93),b=n.n(f),w=n(2),v={user:function(){return{loggedIn:!1,id:null,name:"",token:""}},loginForms:function(){return{name:"",login:"",password:"",tab:"registration"}}};function E(e,t,n){return new Promise(function(r){var a=window.location.origin+"/api/";b.a[e](a+t,n).then(function(e){return console.log(">2",e.data),r({result:e.data.result})}).catch(function(e){return console.warn(e),console.warn("resp",e.response),console.log(JSON.stringify(e,["message","arguments","type","name"])),"Network Error"===e.message?r({error:e.message}):r({error:e.response.data})})})}function N(){return k.apply(this,arguments)}function k(){return(k=Object(g.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("START OF ACTUALIZING"),e.next=3,E("get","posts/get");case 3:if(t=e.sent,console.warn("FIN ZH"),!t.error){e.next=8;break}return console.warn("AN ERROR",t.error),e.abrupt("return");case 8:console.warn("POSTS: ",t.result),w.b.posts=t.result;case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(){return(h=Object(g.a)(d.a.mark(function e(t,n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E("post","auth/login",{login:t,password:n});case 2:if(r=e.sent,console.log(">LOIGN",r),!r.error){e.next=7;break}return console.warn("AN ERROR",r.error),e.abrupt("return");case 7:window.localStorage.feed_token=r.result,w.b.loginForms=v.loginForms(),x(r.result);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function x(e){return O.apply(this,arguments)}function O(){return(O=Object(g.a)(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E("get","auth/getMe?token="+t);case 2:if(!(n=e.sent).error){e.next=7;break}return window.localStorage.removeItem("feed_token"),console.warn("WRONG TOKEN, so i am deleting it",n.error),e.abrupt("return");case 7:(r=v.user()).loggedIn=!0,r.name=n.result.name,r.email=n.result.email,r.id=n.result.id,r.token=t,w.b.user=r;case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function F(){return(F=Object(g.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("feed_token"),w.b.user=v.user();case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y(){return(y=Object(g.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E("post","posts/add",{token:w.b.user.token,text:t});case 2:if(!(n=e.sent).error){e.next=6;break}return console.warn("COULDNT ADD POST",n.error),e.abrupt("return");case 6:w.b.newPostText="",N();case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}n(209);var P=function(e){return a.a.createElement("div",{className:"Header"},a.a.createElement("div",null,a.a.createElement("div",null),w.b.user.loggedIn&&a.a.createElement("div",null,a.a.createElement("div",null,w.b.user.name),a.a.createElement("div",{onClick:function(){return function(){return F.apply(this,arguments)}()}},"Logout"))))},T=(n(210),function(e){var t=function(e){return w.b.loginForms.tab=e};return a.a.createElement("div",{className:"loginForms"},a.a.createElement("div",{className:"tabs"},a.a.createElement("div",{className:"registration"===w.b.loginForms.tab&&"active",onClick:function(){t("registration")}},"Registration"),a.a.createElement("div",{className:"login"===w.b.loginForms.tab&&"active",onClick:function(){t("login")}},"Login")),a.a.createElement("div",null,"registration"===w.b.loginForms.tab&&a.a.createElement("input",{type:"text",value:w.b.loginForms.name,placeholder:"Name",onChange:function(e){return w.b.loginForms.name=e.target.value}}),a.a.createElement("input",{type:"text",value:w.b.loginForms.login,placeholder:"Login (email)",onChange:function(e){return w.b.loginForms.login=e.target.value}}),a.a.createElement("input",{type:"password",value:w.b.loginForms.password,placeholder:"Password",onChange:function(e){return w.b.loginForms.password=e.target.value}})),a.a.createElement("div",{className:"button",onClick:function(e){"registration"===w.b.loginForms.tab?window.alert("THERE IS NO Registration POINT"):function(e,t){h.apply(this,arguments)}(w.b.loginForms.login,w.b.loginForms.password)}},"Sign me ","registration"===w.b.loginForms.tab?"up":"in"))}),C=(n(211),function(e){return a.a.createElement("div",{className:"newPostForm"},a.a.createElement("textarea",{value:w.b.newPostText,onChange:function(e){return w.b.newPostText=e.target.value}}),a.a.createElement("div",{className:"button",onClick:function(){return function(e){return y.apply(this,arguments)}(w.b.newPostText)}},"Add post"))}),I=(n(212),function(e){var t=e.post,n=new Date(t.datetime);n=n.toString().split(" ");var r="".concat(n[1]," ").concat(n[2]," ").concat(n[3]," ").concat(n[4]);return a.a.createElement("div",{key:t.id,className:"aPost"},a.a.createElement("div",{className:"userName"},t.authorname),a.a.createElement("div",{className:"postDatetime"},r),a.a.createElement("div",{className:"text"},t.text))}),R=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){console.log("App mounted at ",window.location),console.log(Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_NNAA:"123"})),N(),window.localStorage.feed_token&&(console.log(" heaf goog ",window.localStorage.feed_token),x(window.localStorage.feed_token))}},{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement(P,null),a.a.createElement("div",{className:"topPanel"},a.a.createElement("div",null,w.b.user.loggedIn?a.a.createElement(C,null):a.a.createElement(T,null))),a.a.createElement("div",{className:"postList"},a.a.createElement("div",null,w.b.posts.map(function(e){return a.a.createElement(I,{key:e.id,post:e})}))),a.a.createElement("div",{className:"footer"},a.a.createElement("div",null,a.a.createElement("div",null,"\xa9 Romka 2019"),a.a.createElement("div",null,"a test project"),a.a.createElement("div",null,"v0.02"))))}}]),t}(r.Component);w.b.user=v.user(),w.b.posts=[],w.b.newPostText="",w.b.loginForms=v.loginForms(),s.a.render(a.a.createElement(w.a,null,a.a.createElement(R,null)),document.getElementById("root"))},94:function(e,t,n){e.exports=n(213)}},[[94,1,2]]]);
//# sourceMappingURL=main.97a807d7.chunk.js.map